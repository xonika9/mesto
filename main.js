(()=>{"use strict";function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function t(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var r=t((function e(t,r,o,i,c,u){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n(this,"_getTemplate",(function(){return document.querySelector(a._templateSelector).content.querySelector(".card").cloneNode(!0)})),n(this,"handleRemoveCard",(function(){a._newCard.remove(),a._newCard=null})),n(this,"getCardId",(function(){return a._card._id})),n(this,"_isMyLike",(function(){return a._card.owner._id===a._userId})),n(this,"isLiked",(function(){return a._card.likes.some((function(e){return e._id===a._userId}))})),n(this,"setLike",(function(e){a._card=e,a.isLiked()?a._likeButton.classList.add("card__like_active"):a._likeButton.classList.remove("card__like_active"),a._likeCounter.textContent=a._card.likes.length})),n(this,"_setEventListeners",(function(){a._likeButton.addEventListener("click",(function(){return a._toggleLike(a)})),a._removeButton.addEventListener("click",(function(){return a._handleRemove(a)})),a._cardImage.addEventListener("click",(function(){return a._handleCardClick({name:a._card.name,link:a._card.link})}))})),n(this,"generateCard",(function(){return a._newCard=a._getTemplate(),a._newCard.querySelector(".card__title").textContent=a._card.name,a._newCard.querySelector(".card__like-counter").textContent=a._likeCounter,a._cardImage=a._newCard.querySelector(".card__photo"),a._cardImage.src=a._card.link,a._cardImage.alt=a._card.name,a._likeButton=a._newCard.querySelector(".card__like"),a._removeButton=a._newCard.querySelector(".card__remove"),a._isMyLike()||(a._removeButton.classList.add("card__remove_disabled"),a._removeButton.setAttribute("disabled",!0)),a._likeCounter=a._newCard.querySelector(".card__like-counter"),a._setEventListeners(),a.setLike(a._card),a._newCard})),this._card=t,this._templateSelector=r,this._handleCardClick=o,this._handleRemove=i,this._toggleLike=c,this._userId=u}));const o=r;function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a=c((function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),u(this,"_showInputError",(function(e){var t=document.querySelector(".".concat(e.id,"-error"));t.classList.add(r._errorClass),e.classList.add(r._inputErrorClass),t.textContent=e.validationMessage})),u(this,"_hideInputError",(function(e){var t=document.querySelector(".".concat(e.id,"-error"));t.classList.remove(r._errorClass),e.classList.remove(r._inputErrorClass),t.textContent=""})),u(this,"_checkInputValidity",(function(e){e.validity.valid?r._hideInputError(e):r._showInputError(e),r._toggleButtonState()})),u(this,"resetValidation",(function(){r._inputList.forEach((function(e){r._hideInputError(e)})),r._toggleButtonState()})),u(this,"_toggleButtonState",(function(){r._buttonElement.disabled=!r._formElement.checkValidity(),r._buttonElement.classList.toggle(r._inactiveButtonClass,!r._formElement.checkValidity())})),u(this,"enableValidation",(function(){r._inputList.forEach((function(e){e.addEventListener("input",(function(){return r._checkInputValidity(e)}))})),r._toggleButtonState()})),this._formSelector=t.formSelector,this._inputSelector=t.inputSelector,this._submitButtonSelector=t.submitButtonSelector,this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._errorClass=t.errorClass,this._formElement=n,this._buttonElement=this._formElement.querySelector(this._submitButtonSelector),this._inputList=Array.from(this._formElement.querySelectorAll(this._inputSelector))}));const l=a;function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const d=f((function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),p(this,"addItem",(function(e){var t=r._renderer(e);r._container.prepend(t)})),p(this,"renderItems",(function(e){e.forEach((function(e){return r.addItem(e)}))})),this._renderer=t,this._container=document.querySelector(n)}));function _(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const h=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),y(this,"_handleEscClose",(function(e){"Escape"===e.key&&n.close()})),y(this,"_handleCloseOnClick",(function(e){(e.target===e.currentTarget||e.target.classList.contains("popup__close-button"))&&n.close()})),this._popup=document.querySelector(t)}var t,n;return t=e,(n=[{key:"open",value:function(){this._popup.classList.add("popup_is-opened"),document.addEventListener("keydown",this._handleEscClose)}},{key:"close",value:function(){this._popup.classList.remove("popup_is-opened"),document.removeEventListener("keydown",this._handleEscClose)}},{key:"setEventListeners",value:function(){this._popup.addEventListener("mousedown",this._handleCloseOnClick)}}])&&_(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}function m(e,t){return m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},m(e,t)}function v(e,t){if(t&&("object"===b(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return g(e)}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function w(){return w="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=O(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},w.apply(this,arguments)}function O(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=C(e)););return e}function C(e){return C=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},C(e)}const k=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}(i,e);var t,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=C(n);if(r){var o=C(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return v(this,e)});function i(e){var t,n,r,c,u;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),u=function(e){var r=e.name,o=e.link;n._image.src=o,n._image.alt=r,n._caption.textContent=r,w((t=g(n),C(i.prototype)),"open",t).call(t)},(c="open")in(r=g(n=o.call(this,e)))?Object.defineProperty(r,c,{value:u,enumerable:!0,configurable:!0,writable:!0}):r.open=u,n._image=n._popup.querySelector(".popup__image"),n._caption=n._popup.querySelector(".popup__caption"),n}return t=i,Object.defineProperty(t,"prototype",{writable:!1}),t}(h);function E(e){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E(e)}function S(e,t){return S=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},S(e,t)}function j(e,t){if(t&&("object"===E(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return P(e)}function P(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function L(){return L="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=I(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},L.apply(this,arguments)}function I(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=R(e)););return e}function R(e){return R=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},R(e)}function B(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const q=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&S(e,t)}(i,e);var t,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=R(n);if(r){var o=R(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return j(this,e)});function i(e,t){var n,r,c;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),B(P(c=o.call(this,t)),"_getInputValues",(function(){return c._formValues={},c._inputList.forEach((function(e){return c._formValues[e.name]=e.value})),c._formValues})),B(P(c),"setInputValues",(function(e){c._inputList.forEach((function(t){return t.value=e[t.name]}))})),B(P(c),"_submitFormHandler",(function(e){e.preventDefault(),c._handleFormSubmit(c._getInputValues())})),B(P(c),"setEventListeners",(function(){c.form.addEventListener("submit",c._submitFormHandler),L((n=P(c),R(i.prototype)),"setEventListeners",n).call(n)})),B(P(c),"close",(function(){L((r=P(c),R(i.prototype)),"close",r).call(r),c.form.reset()})),B(P(c),"loading",(function(e,t){c._submitButton.textContent=e?"Сохранение...":t})),c._handleFormSubmit=e,c.form=c._popup.querySelector(".popup__form"),c._inputList=c._popup.querySelectorAll(".popup__input"),c._submitButton=c.form.querySelector(".popup__submit-button"),c}return t=i,Object.defineProperty(t,"prototype",{writable:!1}),t}(h);function A(e){return A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},A(e)}function T(e,t){return T=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},T(e,t)}function U(e,t){if(t&&("object"===A(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return x(e)}function x(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function V(){return V="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=D(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},V.apply(this,arguments)}function D(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=N(e)););return e}function N(e){return N=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},N(e)}function F(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const H=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&T(e,t)}(i,e);var t,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=N(n);if(r){var o=N(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return U(this,e)});function i(e,t){var n,r,c;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),F(x(c=o.call(this,t)),"open",(function(e){c.card=e,V((n=x(c),N(i.prototype)),"open",n).call(n)})),F(x(c),"setEventListeners",(function(){V((r=x(c),N(i.prototype)),"setEventListeners",r).call(r),c._submit.addEventListener("click",(function(){return c._handleConfirm(c.card)}))})),c._handleConfirm=e,c._submit=c._popup.querySelector(".popup__submit-button"),c}return t=i,Object.defineProperty(t,"prototype",{writable:!1}),t}(h);function M(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function J(e,t,n){return t&&M(e.prototype,t),n&&M(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function z(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var $=J((function e(t){var n=this,r=t.userName,o=t.userAbout,i=t.userAvatar;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),z(this,"getUserInfo",(function(){return{name:n._userName.textContent,about:n._userAbout.textContent}})),z(this,"setUserInfo",(function(e){n._userName.textContent=e.name,n._userAbout.textContent=e.about,n._userAvatar.style.backgroundImage="url(".concat(e.avatar,")"),n.userId=e._id})),this._userName=document.querySelector(r),this._userAbout=document.querySelector(o),this._userAvatar=document.querySelector(i)}));const G=$;function K(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Q(e,t,n){return t&&K(e.prototype,t),n&&K(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function W(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const X=Q((function e(t){var n=this,r=t.baseUrl,o=t.headers;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),W(this,"_checkResponse",(function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})),W(this,"setAvatar",(function(e){return fetch("".concat(n._baseUrl,"users/me/avatar"),{method:"PATCH",headers:n._headers,body:JSON.stringify({avatar:e.avatar})}).then(n._checkResponse)})),W(this,"getProfileInfo",(function(){return fetch("".concat(n._baseUrl,"users/me"),{headers:n._headers}).then(n._checkResponse)})),W(this,"setProfileInfo",(function(e){return fetch("".concat(n._baseUrl,"users/me"),{method:"PATCH",headers:n._headers,body:JSON.stringify(e)}).then(n._checkResponse)})),W(this,"getInitialCards",(function(){return fetch("".concat(n._baseUrl,"cards"),{headers:n._headers}).then(n._checkResponse)})),W(this,"addCard",(function(e){return fetch("".concat(n._baseUrl,"cards"),{method:"POST",headers:n._headers,body:JSON.stringify({name:e.title,link:e.link})}).then(n._checkResponse)})),W(this,"removeCard",(function(e){return fetch("".concat(n._baseUrl,"cards/").concat(e),{method:"DELETE",headers:n._headers}).then(n._checkResponse)})),W(this,"addLike",(function(e){return fetch("".concat(n._baseUrl,"cards/").concat(e,"/likes"),{method:"PUT",headers:n._headers}).then(n._checkResponse)})),W(this,"removeLike",(function(e){return fetch("".concat(n._baseUrl,"cards/").concat(e,"/likes"),{method:"DELETE",headers:n._headers}).then(n._checkResponse)})),this._baseUrl=r,this._headers=o}));var Y=document.querySelector(".profile__edit-button"),Z=document.querySelector(".profile__add-button"),ee=document.querySelector(".profile__avatar"),te={};function ne(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var re=function(e){var t=e.name,n=e.link;pe.open({name:t,link:n})},oe=function(e){de.open(e)},ie=function(e){e.isLiked()?ce.removeLike(e.getCardId()).then((function(t){e.setLike(t)})).catch((function(e){return console.log(e)})):ce.addLike(e.getCardId()).then((function(t){e.setLike(t)})).catch((function(e){return console.log(e)}))},ce=new X({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-43/",headers:{authorization:"3561314d-9c6f-4e96-b81e-d301e13da90c","Content-Type":"application/json"}}),ue=new d((function(e){return new o(e,".card__template",re,oe,ie,ae.userId).generateCard()}),".elements"),ae=new G({userName:".profile__name",userAbout:".profile__about",userAvatar:".profile__avatar"});Promise.all([ce.getProfileInfo(),ce.getInitialCards()]).then((function(e){var t,n,r=(n=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],c=!0,u=!1;try{for(n=n.call(e);!(c=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{c||null==n.return||n.return()}finally{if(u)throw o}}return i}}(t,n)||function(e,t){if(e){if("string"==typeof e)return ne(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ne(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],i=r[1];ae.setUserInfo(o),ue.renderItems(i.reverse())})).catch((function(e){return console.log(e)}));var le,se=new q((function(e){se.loading(!0),ce.setProfileInfo(e).then((function(e){ae.setUserInfo(e),se.close()})).catch((function(e){return console.log(e)})).finally((function(){return se.loading(!1,"Сохранить")}))}),".popup_type_edit-profile"),fe=new q((function(e){fe.loading(!0),ce.addCard(e).then((function(e){ue.addItem(e),fe.close()})).catch((function(e){return console.log(e)})).finally((function(){return fe.loading(!1,"Cоздать")}))}),".popup_type_add-card"),pe=new k(".popup_type_image"),de=new H((function(e){ce.removeCard(e.getCardId()).then((function(){e.handleRemoveCard(),de.close()})).catch((function(e){return console.log(e)}))}),".popup_type_confirm"),_e=new q((function(e){_e.loading(!0),ce.setAvatar(e).then((function(e){ae.setUserInfo(e),_e.close()})).catch((function(e){return console.log(e)})).finally((function(){_e.loading(!1,"Сохранить")}))}),".popup_type_update-avatar");Y.addEventListener("click",(function(){se.setInputValues(ae.getUserInfo()),te.profile__form.resetValidation(),se.open()})),Z.addEventListener("click",(function(){te.add__form.resetValidation(),fe.open()})),ee.addEventListener("click",(function(){te.avatar__form.resetValidation(),_e.open()})),le={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__submit-button",inactiveButtonClass:"popup__submit-button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"},Array.from(document.querySelectorAll(le.formSelector)).forEach((function(e){var t=new l(le,e),n=e.getAttribute("name");te[n]=t,t.enableValidation()})),se.setEventListeners(),fe.setEventListeners(),pe.setEventListeners(),de.setEventListeners(),_e.setEventListeners()})();
//# sourceMappingURL=main.js.map